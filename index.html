<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TT Space Rocks</title>
    <style>
        * {
            padding: 0;
            margin: 0;
            box-sizing: border-box;
        }
        body {
            width: 100%;
            height: 100vh;
            overflow: hidden;
            background: black;
        }
        #tela-inicial, #tela-game-over { /* aplicados os css nas telas inicial e de game over */
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }
        #tela-inicial {
            background: black;
        }
        #tela-game-over {
            background: rgba(0, 0, 0, 0.9);
            display: none; /* Ocultar para que não apareça no início */
        }
        #tela-inicial img, #tela-game-over img { /* css das imagens */
            max-width: 80%;
            max-height: 60%;
        }
        .btn {
            width: 200px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .btn:hover {
            transform: scale(1.1);
        }
    </style>
</head>
<body>

    <div id="tela-inicial">
        <img src="imagens/titulo.png" alt="Título do jogo"> <!-- Coleta a imagem do diretório "imagens"-->
        <img id="start-btn" class="btn" src="imagens/botao.png" alt="Botão Iniciar"> <!-- Coleta a imagem do diretório "imagens"-->
    </div>

    <div id="tela-game-over">
        <img src="imagens/gameover.png" alt="Game Over"> <!-- Coleta a imagem do diretório "imagens"-->
        <img id="restart-btn" class="btn" src="imagens/botao.png" alt="Botão Reiniciar"> <!-- Coleta a imagem do diretório "imagens"-->
    </div>

    <canvas></canvas>

    <script>
        const width = window.innerWidth; // Se adequa a largura da tela da máquina
        const height = window.innerHeight; // Se adequa a altura da tela da máquina
        const canvas = document.querySelector('canvas'); // Armazena o canvas em uma constante
        canvas.width = width; // Iguala a largura do canvas à largura da janela da máquina
        canvas.height = height; // Iguala a altura do canvas à altura da janela da máquina
        const c = canvas.getContext('2d'); // Armazenamento do 2d do canvas em uma constante, permite desenhar formas, textose e imagens e muito mais no canvas.


        let jogoIniciado = false;
        let gameOver = false;
        let rochas = [];
        let tiros = [];
        let navePos = { x: width / 2 - 50, y: height - 100 };

        const rochaImg = new Image();
        rochaImg.src = 'imagens/stone_PNG13556.png';
        const naveImg = new Image();
        naveImg.src = 'imagens/Spaceship-PNG-File.png';

        function iniciarJogo() {
            document.getElementById("tela-inicial").style.display = "none";
            document.getElementById("tela-game-over").style.display = "none";
            jogoIniciado = true;
            gameOver = false;
            rochas = [...Array(5)].map(() => ({ x: Math.random() * (width - 50), y: 0 }));
            tiros = [];
            animate();
        }

        function mostrarGameOver() {
            gameOver = true;
            document.getElementById("tela-game-over").style.display = "flex";
        }

        function atirar() {
            if (!gameOver) {
                tiros.push({ x: navePos.x + 45, y: navePos.y - 20, width: 10, height: 20, speed: 5 });
            }
        }

        function animate() {
            if (!jogoIniciado || gameOver) return;
            requestAnimationFrame(animate);
            c.fillStyle = 'black';
            c.fillRect(0, 0, width, height);

            for (let rocha of rochas) {
                rocha.y += 1;
                c.drawImage(rochaImg, rocha.x, rocha.y, 50, 50);
                if (rocha.y > height) {
                    rocha.y = 0;
                    rocha.x = Math.random() * (width - 50);
                }
                if (checkCollision({ x: navePos.x, y: navePos.y, width: 100, height: 100 }, rocha)) {
                    mostrarGameOver();
                    return;
                }
            }

            c.drawImage(naveImg, navePos.x, navePos.y, 100, 100);

            for (let i = 0; i < tiros.length; i++) {
                let tiro = tiros[i];
                tiro.y -= tiro.speed;
                c.fillStyle = 'red';
                c.fillRect(tiro.x, tiro.y, tiro.width, tiro.height);
                for (let j = 0; j < rochas.length; j++) {
                    let rocha = rochas[j];
                    if (checkCollision(tiro, rocha)) {
                        tiros.splice(i, 1);
                        rochas.splice(j, 1);
                        rochas.push({ x: Math.random() * (width - 50), y: 0 });
                        i--;
                        break;
                    }
                }
            }
        }

        function checkCollision(rect1, rect2) {
            return rect1.x < rect2.x + 50 &&
                   rect1.x + rect1.width > rect2.x &&
                   rect1.y < rect2.y + 50 &&
                   rect1.y + rect1.height > rect2.y;
        }

        window.addEventListener('keydown', (e) => {
            if (!jogoIniciado || gameOver) return;
            if (e.key === 'ArrowRight' && navePos.x < width - 100) navePos.x += 40;
            if (e.key === 'ArrowLeft' && navePos.x > 5) navePos.x -= 40;
            if (e.key === ' ' || e.key === 'Spacebar') atirar();
        });

        document.getElementById('start-btn').addEventListener('click', iniciarJogo);
        document.getElementById('restart-btn').addEventListener('click', iniciarJogo);
    </script>

</body>
</html>